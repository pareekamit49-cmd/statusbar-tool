<input type="file" id="screenshotUploader" accept="image/*" />
<canvas id="mergedCanvas" style="display:none;"></canvas>
<button onclick="downloadMerged()">Download Final Image</button>
<script>
  let uploadedScreenshot = null;

  document.getElementById('screenshotUploader').addEventListener('change', function (e) {
    const reader = new FileReader();
    reader.onload = function (event) {
      const img = new Image();
      img.onload = function () {
        uploadedScreenshot = img;
        mergeStatusBar();
      };
      img.src = event.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });

  function mergeStatusBar() {
    const canvas = document.getElementById('mergedCanvas');
    const ctx = canvas.getContext('2d');

    const statusBar = document.getElementById('statusBarImage'); // id of selected PNG
    const width = uploadedScreenshot.width;
    const height = uploadedScreenshot.height;

    canvas.width = width;
    canvas.height = height;

    ctx.drawImage(uploadedScreenshot, 0, 0, width, height); // base screenshot
    ctx.drawImage(statusBar, 0, 0, width, statusBar.height); // overlay on top

    canvas.style.display = 'block';
  }

  function downloadMerged() {
    const canvas = document.getElementById('mergedCanvas');
    const link = document.createElement('a');
    link.download = 'final-image.png';
    link.href = canvas.toDataURL();
    link.click();
  }
</script>
<img id="statusBarImage" src="statusbars/vivo.png" style="display:none;" />
